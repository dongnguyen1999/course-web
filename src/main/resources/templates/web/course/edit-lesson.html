<!DOCTYPE html>
<html lang="en" xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org">
<head>
  <title th:unless="${lesson != null}">Thêm bài học</title>
  <title th:if="${lesson != null}">Sửa bài học</title>
  <th:block th:replace="web/fragments/general :: meta"/>
  <th:block th:replace="web/fragments/general :: link"/>
  <link rel="stylesheet" th:href="@{/web/css/edit-lesson.css}">
</head>
<body class="bg-light">
<div th:replace="web/fragments/general :: header"></div>
<div id="wrapper" class="wrapper-content">
<!-- <div class="container-fluid p-4 bg-light">
  <form id="createLessonForm" action="" method="post" novalidate>
    <input type="hidden" name="courseId" th:value="${course.id}">
    <input th:if="${lesson != null}" type="hidden" name="idNo" th:value="${lesson.idNo}">
    <div class="row">
      <div class="col-md-8">
        <div class="form-group">
          <label class="control-label" for="title">Tựa đề bài học:</label>
          <input type="text" class="form-control" id="title" name="title" required
                 th:placeholder="'Bài học ' + ${course.nextAvailableLessonNo}"
                 th:value="${lesson != null}? ${lesson.title}: ''">
          <div class="invalid-feedback">
            <span>Tựa đề không được bỏ trống</span>
          </div>
        </div>
        <div class="form-group row m-0 mb-2">
          <label class="col-sm-3 col-md-3 p-0 control-label" for="duration">Thời lượng:</label>
          <select class="col-sm-4 col-md-4 custom-select" id="duration" name="duration">
            <option selected value="">Chưa xác định</option>
            <th:block th:each="i: ${#numbers.sequence(5, 250, 5)}">
              <option th:value="${i}" th:text="'khoảng ' + ${i} + ' phút'" th:selected="${lesson != null && lesson.duration == i}"></option>
            </th:block>
          </select>
        </div>
        <div class="form-group d-flex flex-row">
          <label class="control-label" for="enableFreeTrial">Cho phép xem thử</label>
          <button type="button" class="btn btn-outline-dark checkbox ml-3" th:classappend="${lesson != null && lesson.enableFreeTrial}? 'checked': ''" aria-label="Chọn"
                  title="Chọn">
            <i class="fas fa-check"></i>
          </button>
          <input type="hidden" name="enableFreeTrial" value="false" id="enableFreeTrial">
        </div>
        <div class="form-group">
          <label class="control-label" for="shortDescription">Mô tả ngắn bài học</label>
          <textarea class="form-control" id="shortDescription" name="shortDescription" th:text="${lesson != null}? ${lesson.shortDescription}: ''"></textarea>
        </div>
        <div class="form-group">
          <label class="control-label" for="content">Nội dung bài học</label>
          <textarea class="form-control" id="content" name="content" th:text="${lesson != null}? ${lesson.content}: ''"></textarea>
        </div>

      </div>
      <div class="col-md-4 d-flex flex-column align-items-center">
        <div class="card d-none d-md-block">
          <img class="card-img-top card-img-thumbnail" th:src="'/resource/' + ${course.thumbnail}" src=""
               alt="Course thumbnail">
          <div class="card-body">
            <h3 class="card-title font-weight-bold" th:text="${course.title}">Title</h3>
            <h4 class="card-subtitle" th:text="${course.price != 0}? ${course.price}: 'Miễn phí'">
              10000 VND</h4>
            <hr>
            <p class="card-text" th:utext="${course.shortDescription}?: 'Không có mô tả'">Short description</p>
          </div>
        </div>
        <button class="btn primary outline m-5 d-none d-md-block" type="submit" th:text="${lesson != null}? 'CẬP NHẬT BÀI HỌC': 'THÊM BÀI HỌC MỚI'">THÊM BÀI HỌC MỚI</button>
      </div>
    </div><!--row.-->
    <!-- <div class="row d-flex justify-content-center m-2">
      <button class="btn primary outline d-block d-md-none" type="submit" th:text="${lesson != null}? 'CẬP NHẬT BÀI HỌC': 'THÊM BÀI HỌC MỚI'">THÊM BÀI HỌC MỚI</button>
    </div>
  </form>
  <div th:replace="web/fragments/modal :: informationModal(
        showCondition=${createLessonFailed == true},
        headerColor='bg-danger',
        title='Thêm bài học thất bại',
        content='Có gì đó sai sai<br>Có thể do hệ thống quá tải, vui lòng thử lại sau'
      )"></div>
</div>container. --> -->


    <!-- Page Content -->
    <div class="container">
      <form id="createLessonForm" action="" method="post" novalidate>
        <input type="hidden" name="courseId" th:value="${course.id}">
        <input th:if="${lesson != null}" type="hidden" name="idNo" th:value="${lesson.idNo}">
      <div class="row">
  
        <!-- Post Content Column -->
        <div class="col-lg-8 lesson-content">
  
          <div class="form-group">
            <label class="control-label" for="title">Tựa đề bài học:</label>
            <input type="text" class="form-control" id="title" name="title" required
                   th:placeholder="'Bài học ' + ${course.nextAvailableLessonNo}"
                   th:value="${lesson != null}? ${lesson.title}: ''">
            <div class="invalid-feedback">
              <span>Tựa đề không được bỏ trống</span>
            </div>
          </div>
          <div class="form-group row m-0 mb-2">
            <label class="col-sm-3 col-md-3 p-0 control-label" for="duration">Thời lượng:</label>
            <select class="col-sm-4 col-md-4 custom-select" id="duration" name="duration">
              <option selected value="">Chưa xác định</option>
              <th:block th:each="i: ${#numbers.sequence(5, 250, 5)}">
                <option th:value="${i}" th:text="'khoảng ' + ${i} + ' phút'" th:selected="${lesson != null && lesson.duration == i}"></option>
              </th:block>
            </select>
          </div>
          <div class="form-group d-flex flex-row">
            <label class="control-label" for="enableFreeTrial">Cho phép xem thử</label>
            <button type="button" class="btn btn-outline-dark checkbox ml-3" th:classappend="${lesson != null && lesson.enableFreeTrial}? 'checked': ''" aria-label="Chọn"
                    title="Chọn">
              <i class="fas fa-check"></i>
            </button>
            <input type="hidden" name="enableFreeTrial" value="false" id="enableFreeTrial">
          </div>
          <div class="form-group">
            <label class="control-label" for="shortDescription">Mô tả ngắn bài học</label>
            <textarea class="form-control" id="shortDescription" name="shortDescription" th:text="${lesson != null}? ${lesson.shortDescription}: ''"></textarea>
          </div>
          <div class="form-group">
            <label class="control-label" for="content">Nội dung bài học</label>
            <textarea class="form-control" id="content" name="content" th:text="${lesson != null}? ${lesson.content}: ''"></textarea>
          </div>
          
  
        </div><!-- left content -->
  
        <!-- Sidebar Widgets Column -->
        <div class="col-md-4">
          <div class="card d-none d-md-block my-4 course-item">
            <img class="card-img-top card-img-thumbnail" th:src="'/resource/' + ${course.thumbnail}" src=""
                 alt="Course thumbnail">
            <div class="card-body">
              <a th:href="'/course/'+${course.code}"><h3 class="card-title font-weight-bold" th:text="${course.title}">Title</h3></a>
              <h4 class="card-subtitle" th:text="${course.price != 0}? ${course.price}: 'Miễn phí'">
                10000 VND</h4>
              <hr>
              <div class="card-detail">
                <div class="card-text mb-1 max-lines-3" th:utext="${course.shortDescription}">Course short description</div>
              </div>
              <div class="d-flex justify-content-center">
                <button class="btn primary outline" type="submit" th:text="${lesson != null}? 'CẬP NHẬT BÀI HỌC': 'THÊM BÀI HỌC MỚI'">THÊM BÀI HỌC MỚI</button>
              </div>
              
            </div>
          </div>
  
          <!-- Side Widget -->
          <div class="card my-4 lesson-list" th:if="${(lesson != null) && (lessons.size() > 0)}">
            <h5 class="card-header">Danh sách bài học</h5>
            <div class="card-body overflow-auto p-0" style="max-height: 30rem;">
              <div class="list-group">
                <a th:each="item : ${lessons}" class="list-group-item list-group-item-action" 
                  th:text="${item.idNo} + '. ' + ${item.title}" 
                  th:href="'/course/'+${course.code}+'/lesson-'+${item.idNo}+'/edit'" 
                  th:classappend="|${(item.idNo == lesson.idNo) ?'active':''} ${((user == null || user.role == null) && (item.enableFreeTrial == false)) ?'disabled':''}|"
                  >
                  1. Cras justo odio
                </a>
              </div>
            </div>
          </div>
  
        </div>
  
      </div>
      <!-- /.row -->
      <div class="row d-flex justify-content-center m-2">
        <button class="btn primary outline d-block d-md-none" type="submit" th:text="${lesson != null}? 'CẬP NHẬT BÀI HỌC': 'THÊM BÀI HỌC MỚI'">THÊM BÀI HỌC MỚI</button>
      </div>
    </form>
    </div>
    <!-- /.container -->


</div><!--wrapper content.-->

<div th:replace="web/fragments/general :: footer"></div>
<th:block th:replace="web/fragments/general :: script"/>
<script src="https://cdn.ckeditor.com/4.15.0/basic/ckeditor.js"></script>
<script th:src="@{/web/js/common.js}"></script>
<script th:replace="web/fragments/modal :: informationModalController(showCondition=${createLessonFailed == true})"></script>

<script>
  CKEDITOR.replace('shortDescription');
  CKEDITOR.replace('content', {
    height: '45rem',
  });
  $(function () {
    useBtnCheckbox();
    simpleFormValidation('createLessonForm');
  })
</script>
</body>
</html>